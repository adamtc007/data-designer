{
  "rule_mappings": [
    {
      "rule_id": "RULE_KYC_COMPLETENESS",
      "rule_name": "Calculate KYC Completeness Score",
      "description": "Determine overall KYC documentation completeness percentage",
      "source_dataset": "compliance_review_001",
      "rule_expression": "(documents_received / documents_required) * 100",
      "target_attributes": {
        "kyc_completion_percentage": "number",
        "completeness_score": "number",
        "documentation_status": "string"
      },
      "expected_result": 80
    },
    {
      "rule_id": "RULE_CLIENT_ID_FORMAT",
      "rule_name": "Generate Standard Client Identifier",
      "description": "Create standardized client ID with entity type and jurisdiction",
      "source_dataset": "institutional_client_001",
      "rule_expression": "CONCAT(SUBSTRING(entity_type, 0, 3), \"_\", jurisdiction, \"_\", client_id)",
      "target_attributes": {
        "standard_client_id": "string",
        "formatted_identifier": "string",
        "system_reference": "string"
      },
      "expected_result": "inv_Delaware_INST_2024_00156"
    },
    {
      "rule_id": "RULE_RISK_SCORE_CALC",
      "rule_name": "Calculate Composite Risk Score",
      "description": "Calculate weighted risk score based on multiple risk factors",
      "source_dataset": "risk_assessment_001",
      "rule_expression": "(LOOKUP(country_risk, \"risk_ratings\") * 0.2 + LOOKUP(industry_risk, \"risk_ratings\") * 0.2 + LOOKUP(client_type_risk, \"risk_ratings\") * 0.3 + LOOKUP(transaction_risk, \"risk_ratings\") * 0.3)",
      "target_attributes": {
        "composite_risk_score": "number",
        "risk_level": "string",
        "review_frequency": "string"
      },
      "expected_result": 2.3
    },
    {
      "rule_id": "RULE_FEE_CALCULATION",
      "rule_name": "Calculate Custody Fees",
      "description": "Calculate annual custody fees based on AUM and fee tier",
      "source_dataset": "institutional_client_001",
      "rule_expression": "aum_usd * LOOKUP(\"institutional_tier_1\", \"fee_tiers\")",
      "target_attributes": {
        "annual_custody_fee": "number",
        "monthly_fee": "number",
        "fee_basis_points": "number"
      },
      "expected_result": 8500000
    },
    {
      "rule_id": "RULE_ONBOARDING_STATUS",
      "rule_name": "Determine Onboarding Status",
      "description": "Calculate onboarding workflow status based on document completion",
      "source_dataset": "compliance_review_001",
      "rule_expression": "IF kyc_completeness >= 100 THEN \"ready_for_approval\" ELSE IF kyc_completeness >= 80 THEN \"pending_documents\" ELSE \"incomplete\"",
      "target_attributes": {
        "onboarding_status": "string",
        "workflow_stage": "string",
        "action_required": "string"
      },
      "expected_result": "pending_documents"
    },
    {
      "rule_id": "RULE_AUTHORITY_VALIDATION",
      "rule_name": "Validate Trading Authority",
      "description": "Check if authorized person has valid trading permissions",
      "source_dataset": "authorized_persons_001",
      "rule_expression": "IF trading_authority = true AND background_check_status = \"approved\" AND authority_limit_usd > 0 THEN \"authorized\" ELSE \"restricted\"",
      "target_attributes": {
        "trading_permission": "string",
        "authorization_status": "string",
        "permission_level": "string"
      },
      "expected_result": "authorized"
    },
    {
      "rule_id": "RULE_REGULATORY_FLAG",
      "rule_name": "Generate Regulatory Reporting Flag",
      "description": "Determine regulatory reporting requirements based on jurisdiction and type",
      "source_dataset": "institutional_client_001",
      "rule_expression": "CONCAT(LOOKUP(primary_regulator, \"regulatory_bodies\"), \" - \", regulatory_status, \" [\", registration_number, \"]\")",
      "target_attributes": {
        "regulatory_identifier": "string",
        "reporting_requirement": "string",
        "regulator_reference": "string"
      },
      "expected_result": "Securities and Exchange Commission - registered_investment_advisor [801-123456]"
    },
    {
      "rule_id": "RULE_DOC_MISSING",
      "rule_name": "Identify Missing Documents",
      "description": "Count number of pending or missing critical documents",
      "source_dataset": "document_checklist_001",
      "rule_expression": "IF audited_financials = \"pending\" THEN 1 ELSE 0 + IF legal_opinion = \"pending\" THEN 1 ELSE 0 + IF beneficial_ownership_chart = \"pending\" THEN 1 ELSE 0",
      "target_attributes": {
        "missing_documents_count": "number",
        "critical_documents_pending": "number",
        "documentation_gaps": "string"
      },
      "expected_result": 3
    },
    {
      "rule_id": "RULE_ACCOUNT_LABEL",
      "rule_name": "Generate Account Label",
      "description": "Create formatted account label with client name and account type",
      "source_dataset": "account_structure_001",
      "rule_expression": "CONCAT(account_name, \" [\", account_type, \"] - \", base_currency, \" (Fee: \", LOOKUP(fee_schedule, \"fee_tiers\") * 10000, \" bps)\")",
      "target_attributes": {
        "account_label": "string",
        "display_name": "string",
        "account_description": "string"
      },
      "expected_result": "Apex Capital - Master Fund [master_custody] - USD (Fee: 10 bps)"
    },
    {
      "rule_id": "RULE_PEP_SANCTIONS",
      "rule_name": "PEP and Sanctions Check Status",
      "description": "Determine if enhanced due diligence is required",
      "source_dataset": "authorized_persons_001",
      "rule_expression": "IF pep_status = true OR sanctions_check != \"clear\" THEN \"enhanced_due_diligence\" ELSE \"standard_due_diligence\"",
      "target_attributes": {
        "due_diligence_level": "string",
        "review_requirement": "string",
        "compliance_flag": "string"
      },
      "expected_result": "standard_due_diligence"
    },
    {
      "rule_id": "RULE_FATCA_CRS",
      "rule_name": "Tax Reporting Requirements",
      "description": "Determine tax reporting obligations based on FATCA and CRS status",
      "source_dataset": "account_structure_001",
      "rule_expression": "IF fatca_status = \"participating_ffi\" AND crs_reporting = true THEN \"full_reporting\" ELSE IF fatca_status = \"participating_ffi\" THEN \"fatca_only\" ELSE \"limited_reporting\"",
      "target_attributes": {
        "tax_reporting_requirement": "string",
        "reporting_jurisdiction": "string",
        "withholding_requirement": "string"
      },
      "expected_result": "full_reporting"
    },
    {
      "rule_id": "RULE_REVIEW_PRIORITY",
      "rule_name": "Calculate Review Priority Score",
      "description": "Prioritize compliance review based on AUM, risk, and completeness",
      "source_dataset": "compliance_review_001",
      "rule_expression": "(expected_annual_volume / 100000000) + aml_risk_score + (100 - kyc_completeness) / 20",
      "target_attributes": {
        "priority_score": "number",
        "review_urgency": "string",
        "queue_position": "number"
      },
      "expected_result": 9.95
    },
    {
      "rule_id": "RULE_LEI_VALIDATION",
      "rule_name": "Validate Legal Entity Identifier",
      "description": "Check LEI format and create validation status",
      "source_dataset": "institutional_client_001",
      "rule_expression": "IF legal_entity_identifier != null THEN CONCAT(\"LEI: \", legal_entity_identifier, \" [VALID]\") ELSE \"LEI_REQUIRED\"",
      "target_attributes": {
        "lei_status": "string",
        "lei_validation": "string",
        "identifier_compliance": "string"
      },
      "expected_result": "LEI: 549300VFXB3LH3JW7N94 [VALID]"
    },
    {
      "rule_id": "RULE_APPROVAL_READINESS",
      "rule_name": "Account Approval Readiness Check",
      "description": "Determine if account is ready for final approval",
      "source_dataset": "compliance_review_001",
      "rule_expression": "IF kyc_completeness >= 100 AND approval_status = \"pending_final_review\" AND beneficial_ownership = \"verified\" THEN \"ready_for_approval\" ELSE \"not_ready\"",
      "target_attributes": {
        "approval_readiness": "string",
        "approval_checklist": "string",
        "final_status": "string"
      },
      "expected_result": "not_ready"
    },
    {
      "rule_id": "RULE_SERVICE_LEVEL",
      "rule_name": "Determine Service Level",
      "description": "Assign service level based on AUM and client type",
      "source_dataset": "institutional_client_001",
      "rule_expression": "IF aum_usd > 5000000000 AND entity_type = \"investment_manager\" THEN \"platinum\" ELSE IF aum_usd > 1000000000 THEN \"gold\" ELSE \"silver\"",
      "target_attributes": {
        "service_level": "string",
        "support_tier": "string",
        "relationship_type": "string"
      },
      "expected_result": "platinum"
    }
  ],
  "metadata": {
    "version": "2.0.0",
    "created": "2024-10-07",
    "description": "KYC and institutional client onboarding rules for custody banking",
    "total_rules": 15,
    "domain": "custody_banking",
    "categories": [
      "kyc_compliance",
      "risk_assessment",
      "fee_calculation",
      "regulatory_reporting",
      "document_validation",
      "client_onboarding"
    ],
    "compliance_frameworks": [
      "FATCA",
      "CRS",
      "AML",
      "KYC",
      "MiFID II",
      "Dodd-Frank"
    ]
  }
}